<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Adventure Details</title>
    <link rel="apple-touch-icon" sizes="180x180" href="../../../apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="../../../favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="../../../favicon-16x16.png" />
    <link rel="manifest" href="../../../site.webmanifest" />
    <link rel="mask-icon" href="../../../safari-pinned-tab.svg" color="#5bbad5" />
    <meta name="msapplication-TileColor" content="#da532c" />
    <meta name="theme-color" content="#222222" />
    <link href="https://fonts.googleapis.com/css2?family=Mulish:wght@400;500;600;700&family=Rubik:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="../../../css/styles.css" />
</head>

<body>
    <!-- Loader Wrapper  -->
    <div id="loader-wrapper">
        <div class="pulsing-6"></div>
    </div>

    <!-- Reservation Error status modal -->
    <div class="reservation-status-container reservation-error">
        <div class="reservation-modal text-center">
            <lord-icon src="https://cdn.lordicon.com/inrunzby.json" class="reservation-map-icon" trigger="loop"
                colors="primary:#ffc738,secondary:#c74b16">
            </lord-icon>
            <h1 class="reservation-greeting-text mb-1">Oops!</h1>
            <p>An error occurred while reserving your adventure.</p>
            <p class="reservation-description-text mb-2">You cannot book adventures for past dates!</p>
            <p class="reservation-description-text reservation-error-message text-muted">
                Please check the date.
            <div class="resrvation-buttons d-flex">
                <button class="btn btn-outline-dark btn-ok">Ok</button>
            </div>
        </div>
    </div>

    <!-- Reservation Success Modal  -->
    <div class="reservation-status-container reservation-success">
        <div class="reservation-modal text-center">
            <lord-icon src="https://cdn.lordicon.com/oaflahpk.json" class="reservation-map-icon" trigger="loop"
                colors="primary:#ff9100" state="hover-jump">
            </lord-icon>
            <h1 class="reservation-greeting-text mb-1">Great!</h1>
            <p class="reservation-description-text mb-2">Your reservation is <span
                    class="reservation-highlight">successful</span>.</p>

            <p class="reservation-thanking-text text-muted">Thank you for booking this adventue with us. We will see you
                on <span class="reservation-date">September 9th.</span></p>
            <div class="resrvation-buttons d-flex">
                <button class="btn btn-outline-dark btn-ok">Ok</button>
            </div>
        </div>
    </div>

    <div id="page">
        <nav class="navbar navbar-expand-lg navbar-light navbar-sticky bg-light p-3">
            <a class="navbar-brand" href="../../../">DreamDestination</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown"
                aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavDropdown">
                <ul class="navbar-nav d-flex justify-content-end w-100">
                    <li class="nav-item active">
                        <a class="nav-link nav-link-first" href="../../../">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../reservations/">Reservations</a>
                    </li>
                </ul>
            </div>
        </nav>
        <div class="container pb-5">
            <div class="content">
                <div class="alert alert-success" id="reserved-banner">
                    Greetings! Reservation for this adventure is successful. (Click
                    <a href="../reservations/"><strong>here</strong></a>
                    to view your reservations)
                </div>
                <div class="row">
                    <div class="col-lg-8">
                        <div class="adventure-detail-card mb-3">
                            <div>
                                <h1 id="adventure-name"></h1>
                                <p style="font-size: 20px; color: #999" id="adventure-subtitle"></p>
                            </div>
                            <div class="row mb-3" id="photo-gallery">
                                <div class="pulsing-6"></div>
                            </div>

                            <hr />
                            <h5>About the Experience</h5>
                            <div id="adventure-content">
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="">
                            <div id="reservation-panel-sold-out">
                                <h3>Sold Out!</h3>
                                <hr />
                                This activity is currently sold out. But there's a lot more to
                                <a href="../../../" style="color: orange !important">explore.</a>
                            </div>
                            <div id="reservation-panel-available">
                                <form id="myForm" action="" method="">
                                    <label>Name</label>
                                    <input type="text" class="form-control" name="name" required
                                        placeholder="Your name here" />
                                    <br />
                                    <label>Pick a Date</label>
                                    <input type="date" class="form-control" name="date" required />
                                    <hr />
                                    <div class=" d-flex align-items-center justify-content-between">
                                        <div>
                                            <h6 class="m-0">Person(s)</h6>
                                            <p class="m-0" style="font-size: 16px; color: #999">
                                            <div class="d-inline">₹</div>
                                            <div class="d-inline" id="reservation-person-cost">0</div> per head
                                            </p>
                                        </div>
                                        <div>
                                            <input type="number" class="form-control" min="1" max="10" value="0"
                                                name="person" required onkeyup="onPersonsChange(event)"
                                                style="width: 100px" />
                                        </div>
                                    </div>
                                    <hr />
                                    <div class="d-flex align-items-center justify-content-between">
                                        <div>
                                            <h6 class="m-0">Total</h6>
                                        </div>
                                        <div>
                                            <h5>
                                                ₹
                                                <div class="d-inline" id="reservation-cost">0</div>
                                            </h5>
                                        </div>
                                    </div>
                                    <button class="reserve-button" type="submit">Reserve</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <footer>
            <div class="container footer-text">© DreamDestination 2022</div>
        </footer>
    </div>



    <!-- Loader Remover script -->
    <script>
        // Get the laoder and page elements from the DOM
        const loaderElement = document.querySelector("#loader-wrapper");
        const pageElement = document.querySelector('#page');

        // Hide the entire page until the page loads
        pageElement.style.display = 'none';

        // Add an event listener to the window object and show the page -
        // when it loads entirely
        window.addEventListener("load", () => {
            loaderElement.style.display = "none";
            pageElement.style.display = 'block';
        });
    </script>

    <!-- Lordicons script -->
    <script src="https://cdn.lordicon.com/xdjxvujz.js"></script>

    <!-- Bootstrap script -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>

    <script type="module">
        import {
            getAdventureIdFromURL,
            fetchAdventureDetails,
            addAdventureDetailsToDOM,
            addBootstrapPhotoGallery,
            conditionalRenderingOfReservationPanel,
            captureFormSubmit,
            calculateReservationCostAndUpdateDOM,
            showBannerIfAlreadyReserved,
            reservationModalBtnFunction
        } from "../../../modules/adventure_details_page.js";
        (async function () {
            let adventureId = await getAdventureIdFromURL(window.location.search);
            let adventureDetails = await fetchAdventureDetails(adventureId);
            addAdventureDetailsToDOM(adventureDetails);
            addBootstrapPhotoGallery(adventureDetails.images);
            conditionalRenderingOfReservationPanel(adventureDetails);
            captureFormSubmit(adventureDetails);
            showBannerIfAlreadyReserved(adventureDetails);
            // reservationModalBtnFunction();
            function onPersonsChange(event) {
                calculateReservationCostAndUpdateDOM(
                    adventureDetails,
                    event.target.value
                );
            }
            window.onPersonsChange = onPersonsChange;
        })();
    </script>
</body>

</html>